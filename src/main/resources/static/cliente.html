<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Gestión de Clientes</title>
</head>
<body>
<h1>Gestión de Clientes</h1>

<h2>Agregar Cliente</h2>
<input type="number" id="id" placeholder="ID">
<input type="text" id="nombre" placeholder="Nombre">
<input type="email" id="gmail" placeholder="Gmail">
<input type="text" id="telefono" placeholder="Teléfono">
<button onclick="crearCliente()">Agregar</button>

<h2>Actualizar Cliente</h2>
<input type="number" id="updId" placeholder="ID a actualizar">
<input type="text" id="updNombre" placeholder="Nuevo Nombre">
<input type="email" id="updGmail" placeholder="Nuevo Gmail">
<input type="text" id="updTelefono" placeholder="Nuevo Teléfono">
<button onclick="actualizarCliente()">Actualizar</button>

<h2>Modificar Parcialmente</h2>
<input type="number" id="patchId" placeholder="ID a modificar">
<input type="text" id="patchNombre" placeholder="Nuevo Nombre (opcional)">
<input type="email" id="patchGmail" placeholder="Nuevo Gmail (opcional)">
<input type="text" id="patchTelefono" placeholder="Nuevo Teléfono (opcional)">
<button onclick="modificarParcial()">Modificar</button>

<h2>Eliminar Cliente</h2>
<input type="number" id="delId" placeholder="ID a eliminar">
<button onclick="eliminarCliente()">Eliminar</button>

<h2>Lista de Clientes</h2>
<button onclick="cargarClientes()">Cargar Clientes</button>
<ul id="listaClientes"></ul>

<script>
    const url = '/clientes';

    function cargarClientes() {
        fetch(url)
            .then(res => res.json())
            .then(data => {
                const lista = document.getElementById("listaClientes");
                lista.innerHTML = "";
                data.forEach(c => {
                    const li = document.createElement("li");
                    li.textContent = `ID: ${c.id} - Nombre: ${c.nombre} - Gmail: ${c.gmail} - Teléfono: ${c.telefono}`;
                    lista.appendChild(li);
                });
            });
    }

    function crearCliente() {
        const id = document.getElementById("id").value;
        const nombre = document.getElementById("nombre").value;
        const gmail = document.getElementById("gmail").value;
        const telefono = document.getElementById("telefono").value;

        fetch(url, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({id: Number(id), nombre, gmail, telefono})
        })
        .then(response => {
            if (response.ok) {
                document.getElementById("id").value = "";
                document.getElementById("nombre").value = "";
                document.getElementById("gmail").value = "";
                document.getElementById("telefono").value = "";
                cargarClientes();
            } else {
                alert("Error al agregar cliente. Revisa los datos.");
            }
        });
    }

    function actualizarCliente() {
        const id = document.getElementById("updId").value;
        const nombre = document.getElementById("updNombre").value;
        const gmail = document.getElementById("updGmail").value;
        const telefono = document.getElementById("updTelefono").value;

        fetch(`${url}/${id}`, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({nombre, gmail, telefono})
        }).then(() => cargarClientes());
    }

    function modificarParcial() {
        const id = document.getElementById("patchId").value;
        const nombre = document.getElementById("patchNombre").value;
        const gmail = document.getElementById("patchGmail").value;
        const telefono = document.getElementById("patchTelefono").value;

        const parcial = {};
        if (nombre) parcial.nombre = nombre;
        if (gmail) parcial.gmail = gmail;
        if (telefono) parcial.telefono = telefono;

        fetch(`${url}/${id}`, {
            method: 'PATCH',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(parcial)
        }).then(() => cargarClientes());
    }

    function eliminarCliente() {
        const id = document.getElementById("delId").value;
        fetch(`${url}/${id}`, {
            method: 'DELETE'
        }).then(() => cargarClientes());
    }
</script>
</body>
</html>
